<html>
<head>
<title>VOS3000</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="expires" content="-1"/>
<meta name="keywords" content="VOS3000, VoIP, VoIP运营支撑系统, 软交换"/>
<meta name="description" content="VOS3000, VoIP, VoIP运营支撑系统, 软交换"/>
<meta name="author" content="www.linknat.com, 昆石网络"/>
<meta name="copyright" content="www.linknat.com, 昆石网络"/>
<link rel="shortcut icon" href="images/vos3000.ico"/>
<link rel="stylesheet" type="text/css" href="css/ext-all.css"/>
<script type="text/javascript" src="js/ext-base.js"></script>
<script type="text/javascript" src="js/ext-all.js"></script>
<script type="text/javascript" src="js/lang.js"></script>
<style type="text/css">
    body {
        font-family: Arial, verdana, tahoma, helvetica, sans-serif;
        padding-top: 32px;
        font-size: 13px;
        background-color: #fff !important;
    }

    h1 {
        font-size: x-large;
    }

    h2 {
        font-size: large;
    }

    .link, .link a {
        color: gray;
    }

    .STYLE1 {
        color: #789030;
        font-size: 12px;
    }

    #login {
        width: 520px;
        position: absolute;
        left: 50%;
        margin-left: -260px;
    }
</style>
<script type="text/javascript">

function changeImg()
{
    document.getElementById('vfcode').src = 'verifyimage.jsp?' + Math.random();
}

Ext.onReady(function()
{
    Ext.MessageBox.wait(s[0], s[1]);
    Ext.QuickTips.init();
    Ext.form.Field.prototype.msgTarget = 'side';
    function Handle()
    {
        if (form.form.isValid())
        {
            Ext.MessageBox.wait(s[53], s[1]);
            Ext.Ajax.request({
                url: 'verify-phonecard.jsp',
                form: form.form.el.dom,
                success: function (result)
                {
                    var r = result.responseText.split("|");
                    if (r[0] == 0)
                    {
                        Ext.MessageBox.show({
                            title: s[54],
                            msg: s[251] + '　' + r[1] + '<br/>' + s[252] + '　' + r[2] + (r[3] > 0 ? '<br/>' + s[253] + '　' + r[3] : ''),
                            buttons: Ext.MessageBox.OK,
                            icon: Ext.MessageBox.INFO
                        });
                    }
                    else
                    {
                        if (r[0] == -4)
                        {
                            r[1] = s[56];
                        }
                        Ext.MessageBox.show({
                            title: s[6],
                            msg: r[1],
                            buttons: Ext.MessageBox.OK,
                            icon: Ext.MessageBox.ERROR
                        });
                    }
                    document.getElementById('randCode').value = "";
                    changeImg();
                },
                failure: function ()
                {
                    Ext.MessageBox.show({
                        title: s[4],
                        msg: s[5],
                        buttons: Ext.MessageBox.OK,
                        icon: Ext.MessageBox.ERROR
                    });
                }
            });
        }
    }

    var form = new Ext.FormPanel({
        labelAlign: 'right',
        labelWidth: 75,
        renderTo: 'login',
        title: "<br><br><h1 align='center'>" + s[8] + "</h1><br><br><h2 align='center'>" + s[9] + "</h2><br>" + "<h6 align='right'>" + s[169] + "</h6>",
        bodyStyle: 'padding:15px 100px 20px',
        items: [
            new Ext.form.FieldSet({
                title: s[250],
                items: [
                    {
                        border: false
                    },
                    new Ext.form.TextField({
                        fieldLabel: s[62],
                        id: 'pin',
                        width: 200,
                        allowBlank: false
                    }),
                    {
                        border: false
                    },
                    new Ext.form.TextField({
                        fieldLabel: s[63],
                        id: 'password',
                        width: 200,
                        inputType: 'password'
                    }),
                    {
                        border: false
                    },
                     new Ext.form.TextField({
                        fieldLabel: s[335],
                        id: 'randCode',
                        width: 80,
                        allowBlank: false
                    }),
                    {
                        border: false
                    },
                    new Ext.Button({
                        text: s[249],
                        minWidth: 100,
                        handler: Handle
                    }),
                    {
                        border: false
                    }
                ]
            })
        ]
    });
    var bd = Ext.getDom('randCode');
    var bd2 = Ext.get(bd.parentNode);
    bd2.createChild([
        {tag: 'span', html:'&nbsp&nbsp&nbsp&nbsp&nbsp'},
        {tag: 'img', id: 'vfcode', src: 'verifyimage.jsp', onclick: 'changeImg();', align:'absbottom'},
        {tag: 'span', html:'&nbsp<a href="javascript:changeImg()">' + s[336] + '</a>'}
    ]);
    new Ext.form.Label({
        html:"<br><br><div align='center'><a href='http://www.linknat.com' class='link'>Powered By Kunshi</a></div><br><br>",
        renderTo:'login'
    });
    new Ext.KeyMap(document, {
        key: Ext.EventObject.ENTER,
        fn: function()
        {
            Handle();
        },
        scope: this
    });
    Ext.MessageBox.hide();
});
</script>
</head>
<body>
<div id="login" align="center"></div>
</body>
</html>